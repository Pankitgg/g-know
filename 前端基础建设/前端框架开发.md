# 框架开发



## 一、目前前端框架及周边生态



### 技术架构

![img](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/17e16c6ac8f16401035d149ed2a36bfe/ffd72684215494ae31a987dd70beb854.png)

**技术架构简介**

从底层到上层分为五层

基础层：对开发使用到的包，要满足基本层的需求，基础层的意义在于有一套基本的**技术选型**，用以开发大部分公共功能。

功能层：是所有前端工程都需要使用到的公共功能，一般服务于前端项目的**开发-部署-测试-上线-维护**。

框架层：是各类框架工程目前包含：**基础，移动端，npm包，微前端，文档**五种。用以方便开发人员快速启动项目。目前均放在wei-cli-common下由脚手架统一构建。

服务层：是提供给前端开发的公共服务，例如 wei-ui，流程引擎，hooks，等等。这些公共服务分为三类，分别是**微前端，npm包，以及node/rust服务**。

平台层：平台层是对技术和积累的总结，用以**知识共享和跨项目复用**。对微前端，包等优秀项目统一设置公共站点和部署文档

### 功能架构

![img](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/6e9fcde3e86a71e9925672c5604b34f4/0ac68b2dc73ee6b649c730562cf822c0.png)

**功能架构简介**

功能上整体分为三部分，分别是脚手架，公共平台，和工具包

脚手架：脚手架是wei-cli工程，通过集成开发常用指令。调用和统一处理wei-cli-common组下的工程。

公共平台：公共大屏平台，物料库

工具包：图标库，类型库，样式库

### 代码组织

目前共有20+个项目分为以下六组

| 分组名/地址                                                  | 中文名     | 简要说明                                                |
| ------------------------------------------------------------ | ---------- | ------------------------------------------------------- |
| [wei-tool](http://10.3.52.122/wei-tool)                      | 公共工具组 | 前端工具包，包含脚手架等                                |
| [wei-cli-common](http://10.3.52.122/wei-cli-common)          | 公共框架组 | 公共框架及模板工程，使用wei-cli进行管理的公共工程       |
| [npm-package-develop](http://10.3.52.122/npm-package-develop) | 公共包组   | 公共npm包仓库用于自动化部署和测试                       |
| [npm-package-framework](http://gitlab.weichai.com:7080/npm-package-framework) | 框架包组   | 在wei-cli-common组中使用的框架包                        |
| [public-service-platform](http://10.3.52.122/public-service-platform) | 公共平台组 | 公共前端开发平台，包含npm包管理，权限管理，微前端管理等 |
| [open-program-plus](http://10.3.52.122/open-program-plus)    | 开源工程   | 通过检测和开发改造的开源项目工程源码                    |

工程分组：是依据**项目技术**和**应用范围**进行分类，并且要满足每个组要有一个**绝对共性**，例如在wei-cli-common组下的所有项目要满足wei-cli脚手架启动以及未来计划能以**组的形式**进行。再比如在公共包组，要满足后续公共包平台开发时，能以**组的形式**进行平台批量化处理每个包的文档和demo。



简介及管理如下（图片展示不再放仓库地址，可在每个项目组中寻找）



**整体**

![img](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/5cb767fe79369cc583be1bf91a305ef3/image.png)



**wei-tool** 和 **wei-cli-common**

![image](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/798d37e19fc21561b6eb066bac2d7c6d/image.png)

wei-tool：目前存在两个项目，wei-cli和toolbox（开发中），wei-tool组里面可以通过调用gitlab平台api来批量的处理wei-cli-common组下的内容。另外wei-tool组下的项目普遍使用node/rust作为编写语言

wei-cli-common：目前存在五个项目，是对外提供和对内使用最多的部分。提供公共的模板工程。使用TS作为开发语言。



**npm-package-framework** 和 **npm-package-develop**

![image](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/9574ed0cab3c7cca33fd560cc9c04b1d/image.png)

这两个组都是开发的npm包，区别在于：npm-package-framework里面的包主要的应用场景在于框架，所以对技术要求是TS，VUE3，VITE等。主要目标是满足框架的使用。而npm-package-develop里面的包是与技术栈无关的，通常是可以在vue、react或其他都使用，并且可以提供给已经开发完成项目使用。主要目标是解决一些通用和常见的前端问题或功能。

**public-service-platform**

![image](http://10.3.52.122/wei-cli-common/vue3-common-framework/uploads/720f281258c8d3e2455a0b5cfe515976/image.png)

目前存在三个项目（开发中）

**open-program-plus**

开源项目维护

1. 预先了解 ：在这个阶段，观察测试和学习开源项目，会暂时放在 [开源选型](http://10.3.52.122/weideveloper/front-end/webfront-development) 。当足够了解后，经过**安全检测**-**确定版本**-**打包运行** 后会进入到 **open-program-plus**组中进行开发
2. 源码开发： 根据定制要求开发内部功能



**各部分开发内容分布**

![](upload/048F8F~1.PNG)

### 技术分类

从技术难度上分了三个等级

1. 业务场景开发                               使用框架进行业务场景开发
2. 框架与组件开发                           甄别技术设计开发
3. node、rust前端服务开发           跨技术栈了解和使用更多技术才能开发



前端技术成长路线，和开发内容融合。分阶段**提供**给前端组

顺序为：**框架维护** =》**公共组件开发** =》**框架开发** =》**公共平台维护开发** =》**node、rust服务开发**



### 二、下一步开发计划

描述：目前所处阶段

​    已经完成必要框架的开发。接下来主要进行 框架服务开发推广，接下来也是目前主要开发内容

1. 提供公共平台

   

   **大屏平台**：满足框架对大屏特定场景下的开发。

   目前阶段：开发70%

   

   ![](upload/3C33E069-549D-4cee-AFB2-25C789712B25.png)

​        

​		**物料库**：组件、微前端、echart、业务模版。

​		目前阶段：基础功能搭建完毕，npm包上传开发功能调试中

![](upload/BF5F1634-EEDE-4301-8269-3D60D513AD43.png)

​		**组件库**：增加新组件，提供新的antd css文件。

​		目前阶段：约开发20%

![](upload/6C568E27-48E4-42b0-A5D1-8915D7CF6414.png)

​       提供公共平台的使用，促进公共组件开发



2. 打通框架和各个平台\服务之间使用

   

   云上流水线：增加流水线配置文件，可以根据具体项目来执行微前端和普通项目在 **云道 **上的流水线

   ![](upload/F473E9C0-8136-4936-842F-CA4C5C908D10.png)

   代码扫描：线下规则使用eslint提供代码提示，在框架中增加对线上平台 **sonarQube** 的支持

   ![](upload/05B4A9E7-7CC6-4166-AECF-A67C1DE0C186.png)

   UI测试：目前框架类项目全部增加了单元测试和端到端测试，增加对**metersphere**测试平台的支持

   ![](upload/82909835-41CD-4050-A2C3-BB8DE1C7EE04.png)

3. 框架日常开发与优化

   

   根据目前UI提供的新规范，开发新的demo界面和新的UI组件（约10页面，40+组件）

   修改框架的构筑选项。

   移动端组件封装，增加对话框场景下的组件

   转移pc端框架V2版本运维

### 时间规划

大块内容

| 时间   | 项目名                               | 项目内容及阶段性成果                                         | 执行                        | 文档及调度                                                   |
| ------ | ------------------------------------ | ------------------------------------------------------------ | --------------------------- | ------------------------------------------------------------ |
| 九月   | 大屏组件、平台                       | 提供公共的设计开发空间和完整的权限管理，在框架中增加微前端使用 | 谷巨州                      | [大屏开发](https://docs.qq.com/smartsheet/DYmNZQk5nUHRWamhB?tab=sc_Lryg51) |
| 十月   | 物料库（npm包部分）、公共方法hooks库 | 提供满足框架中npm包模块的开发、文档、测试，更新hooks库       | 洪湖                        |                                                              |
| 十一月 | 物料库（echart、代码模版部分）       | 提供echart样例，和复杂场景下的代码模版                       | 张亚迪                      |                                                              |
| 十二月 | 物料库（微前端部分）、公共类型仓库   | 将目前的微前端框架更新，并且建立公共管理的空间               | 谷巨州                      |                                                              |
| 明年   | 移动端组件库搭建、对话组件           | 搭建基础组件库，对话组件<br />以对话为核心封装功能           | 洪湖                        |                                                              |
| 明年   | 插件开发                             | 开发框架、chrome、vscode插件：1.增加框架可插拔功能，插件化功能系统<br />2.开发调试和反调试功能包/插件<br /> | 谷巨州                      |                                                              |
| 明年   | sdk开发                              | 1将通用不变的功能和公司级通用前端部分封装成sdk<br />2增加跨系统的前端功能，例如log，无代码调试<br />3增加sdk开发模版工程，文档工程 | 1.张亚迪、2洪湖、3.谷巨州   |                                                              |
| 明年   | 前端埋点(用户行为)平台               | 1.开发前端页面上的用户行为监控，分析判断用户行为<br />2.开发用于埋点的sdk<br />3.增加埋点统计，结果页面 | 1.谷巨州、2.洪湖、3.张亚迪  |                                                              |
| 明年   | 整合UI功能                           | 1.UI文档和样例完善和规范<br />2.图标库规范上传和下载，增加负载能力<br />3.将目前pc、移动、微前端系统中的css统一成单独包 | 1. 张亚迪、2.谷巨州、3.洪湖 |                                                              |
| 明年   | 前端服务授权                         | 对框架和各个包，依托gitlab增加授权方案                       | 谷巨州                      |                                                              |
|        |                                      |                                                              |                             |                                                              |

小块内容

| 时间           | 项目名     | 项目内容及阶段性成功           | 文档及调度                                                   |
| -------------- | ---------- | ------------------------------ | ------------------------------------------------------------ |
| 约一月一次     | 4.0pc版    | 更新版本和内容                 | [框架开发](https://docs.qq.com/sheet/DYm11aU11QUN3cnNv?tab=ss_0xvxdj&viewId=vRXNHz) |
| 约两月一次     | 4.0移动版  | 更新版本和内容                 |                                                              |
| 不定时间       | 4.0微前端  | 更新基础的icestark版本到 2.1.1 |                                                              |
| 约每两周一个   | ui库       | 按照目前新的UI规范开发         | [组件开发](https://docs.qq.com/smartsheet/DYm9qbVFWeFVva0Zi?tab=t9eeWd&viewId=vViIWI) |
| 约一月一个     | 移动端ui库 | 开发移动端UI库的基础组件       |                                                              |
| 根据UI进度调整 | 图标库     | 开发可配置式的图标库           |                                                              |

### 三、 当前问题

一：框架及前端公共服务使用

​       授权方案探索，平台化的对外输出，提供完整的整套服务而非框架源码。

二：框架及服务更新管理

​	   对非使用最新的采用版本管理+fix分支处理，对框架中的采用微前端热更新及公共资源CDN化

三：框架的优缺点

  	开发人员技术视野受限。不断提供新技术给大家使用。

四：添加注释和代码生成



### 其他

[文档站](http://docs.weichai.com:8100/)

[大屏服务](http://10.0.11.29:8222/#/chart/home/3uccrlgt254000)